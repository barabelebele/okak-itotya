import asyncio
import random
from datetime import datetime
from aiogram import Bot, Dispatcher, types
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram.filters import Command
from aiogram.enums import ParseMode
from aiogram.client.default import DefaultBotProperties

# ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
API_TOKEN = '8259801608:A4FTt3qJ3Cx4A2X2g6Xz7voP63yvI4Xhe81k'  # –í–∞—à —Ç–æ–∫–µ–Ω
CHAT_ID = -5111459446  # ID –≤–∞—à–µ–≥–æ —á–∞—Ç–∞
INTERVAL_HOURS = 2  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ (–≤ —á–∞—Å–∞—Ö)

# –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∂–µ–Ω—Å–∫–∏–π)
USER_GENDERS = {
    # –§–æ—Ä–º–∞—Ç: user_id: "male" –∏–ª–∏ "female"
    # –£–∑–Ω–∞—Ç—å user_id –º–æ–∂–Ω–æ —É @userinfobot
    # –ü—Ä–∏–º–µ—Ä: 123456789: "female",  # ID –ø–æ–¥—Ä—É–≥–∏
    #         987654321: "male",    # –í–∞—à ID
}

# ========== 500+ –í–û–ü–†–û–°–û–í –î–õ–Ø –û–ë–©–ï–ù–ò–Ø ==========
QUESTIONS = [
    # –§–ò–õ–û–°–û–§–°–ö–ò–ï
    "–í —á–µ–º —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏ –ø–æ-—Ç–≤–æ–µ–º—É?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å—á–∞—Å—Ç—å–µ –¥–ª—è —Ç–µ–±—è?",
    "–í–µ—Ä–∏—à—å –ª–∏ —Ç—ã –≤ —Å—É–¥—å–±—É?",
    "–ß—Ç–æ –±—ã —Ç—ã —Å–∫–∞–∑–∞–ª–∞ —Å–µ–±–µ —á–µ—Ä–µ–∑ 10 –ª–µ—Ç?",
    "–ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å –≤ –º–∏—Ä–µ?",
    "–ß—Ç–æ –≤–∞–∂–Ω–µ–µ: –ª—é–±–∏—Ç—å –∏–ª–∏ –±—ã—Ç—å –ª—é–±–∏–º–æ–π?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å —Ñ—Ä–∞–∑—É '–∂–∏—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º'?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–≤–æ–±–æ–¥–∞?",
    "–ö–∞–∫–∞—è —Ç–≤–æ—è —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –º–µ—á—Ç–∞?",
    "–ß—Ç–æ —Ç—ã —Ü–µ–Ω–∏—à—å –≤ –ª—é–¥—è—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞—Å—Ç–æ—è—â–∞—è –¥—Ä—É–∂–±–∞?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã –∑–Ω–∞–ª–∞, —á—Ç–æ –∑–∞–≤—Ç—Ä–∞ –∫–æ–Ω–µ—Ü —Å–≤–µ—Ç–∞?",
    "–í —á–µ–º —Ç—ã –≤–∏–¥–∏—à—å —Å–≤–æ–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è —É—Å–ø–µ—Ö?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫—Ä–∞—Å–æ—Ç–∞?",
    "–í–µ—Ä–∏—à—å –ª–∏ —Ç—ã –≤ –ª—é–±–æ–≤—å —Å –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –¥–æ–º?",
    "–ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å –≤ —Å–≤–æ–µ–º –ø—Ä–æ—à–ª–æ–º?",
    "–ß–µ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ –¥–ª—è —Ç–µ–±—è?",
    "–í —á–µ–º —Å–∏–ª–∞ –∂–µ–Ω—â–∏–Ω—ã?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞—Å—Ç–æ—è—â–∞—è —Å–º–µ–ª–æ—Å—Ç—å?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –≤—Ä–µ–º—è?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å —Å–ª–æ–≤–æ '–ø—Ä–æ—â–µ–Ω–∏–µ'?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å?",
    
    # –ê–ë–°–£–†–î–ù–´–ï –ò –°–ú–ï–®–ù–´–ï
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –æ–≤–æ—â–µ–º, —Ç–æ –∫–∞–∫–∏–º?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã —É —Ç–µ–±—è –≤—ã—Ä–æ—Å–ª–∏ –∫—Ä—ã–ª—å—è?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –º–æ–≥–ª–∞ –≥–æ–≤–æ—Ä–∏—Ç—å —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏, —á—Ç–æ –±—ã —Å–ø—Ä–æ—Å–∏–ª–∞ —É —Å–≤–æ–µ–π –∫–æ—à–∫–∏?",
    "–ö–∞–∫ –±—ã —Ç—ã —Å–±–µ–∂–∞–ª–∞ –∏–∑ —Ç—é—Ä—å–º—ã —Å –ø–æ–º–æ—â—å—é –∑—É–±–Ω–æ–π —â–µ—Ç–∫–∏?",
    "–ö–∞–∫–∞—è –±—ã–ª–∞ –±—ã —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –µ—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –∑–ª–æ–¥–µ–π–∫–æ–π?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ —Ü–≤–µ—Ç–æ–º, —Ç–æ –∫–∞–∫–∏–º?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã —Å—Ç–∞–ª–∞ –Ω–µ–≤–∏–¥–∏–º–æ–π?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –ø–æ–≥–æ–¥–æ–π, —Ç–æ –∫–∞–∫–æ–π?",
    "–ö–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ —Ç–æ—á–Ω–æ –≤—ã–∏–≥—Ä–∞–ª–æ –±—ã –≤ –∫–æ–Ω–∫—É—Ä—Å–µ –∫—Ä–∞—Å–æ—Ç—ã?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã –º–æ–≥–ª–∞ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –∑–∞–ø–∞—Ö–æ–º, —Ç–æ –∫–∞–∫–∏–º?",
    "–ö–∞–∫–æ–π –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç —Ç—ã –±—ã –∑–∞–ø–∞—Ç–µ–Ω—Ç–æ–≤–∞–ª–∞?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –≥–µ—Ä–æ–∏–Ω–µ–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º–∞, —Ç–æ –∫–µ–º?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã —É —Ç–µ–±—è –±—ã–ª–æ 3 –∂–µ–ª–∞–Ω–∏—è?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –µ–¥–æ–π, —Ç–æ –∫–∞–∫–æ–π?",
    "–ö–∞–∫–æ–π –±—ã–ª –±—ã —Ç–≤–æ–π —Ç–∞–Ω–µ—Ü, –µ—Å–ª–∏ –±—ã —Ç—ã –≤—ã—Å—Ç—É–ø–∞–ª–∞ –Ω–∞ –ï–≤—Ä–æ–≤–∏–¥–µ–Ω–∏–∏?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç –ø–æ–ø—Ä–æ—Å–∏–ª —É —Ç–µ–±—è —Å–æ–≤–µ—Ç–∞?",
    "–ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª–∞ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º?",
    "–ö–∞–∫–æ–π –±—ã–ª–∞ –±—ã —Ç–≤–æ—è –∫–æ—Ä–æ–Ω–Ω–∞—è —Ñ—Ä–∞–∑–∞ –≤ —Ä–µ–∞–ª–∏—Ç–∏-—à–æ—É?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã –≤—ã–∏–≥—Ä–∞–ª–∞ –º–∏–ª–ª–∏–∞—Ä–¥?",
    
    # –ü–†–û–í–û–ö–ê–¶–ò–û–ù–ù–´–ï
    "–¢—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –Ω–∞—Ä—É—à–∞–ª–∞ –∑–∞–∫–æ–Ω?",
    "–°–∞–º–∞—è –±–æ–ª—å—à–∞—è –ª–æ–∂—å, –∫–æ—Ç–æ—Ä—É—é —Ç—ã –≥–æ–≤–æ—Ä–∏–ª–∞?",
    "–ß—Ç–æ –±—ã —Ç—ã —Å–¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã —É–∑–Ω–∞–ª–∞, —á—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –∂–∏—Ç—å –Ω–µ–¥–µ–ª—é?",
    "–¢—ã –±—ã —Å–º–æ–≥–ª–∞ —É–±–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ —Ä–∞–¥–∏ —Å–ø–∞—Å–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ?",
    "–ö–∞–∫—É—é —Å–∞–º—É—é –±–æ–ª—å—à—É—é –≥–ª—É–ø–æ—Å—Ç—å —Ç—ã —Å–æ–≤–µ—Ä—à–∞–ª–∞ –∏–∑-–∑–∞ –ª—é–±–≤–∏?",
    "–¢—ã –±—ã –ø–æ—à–ª–∞ –Ω–∞ –∏–∑–º–µ–Ω—É —Ä–∞–¥–∏ –¥–µ–Ω–µ–≥?",
    "–ß—Ç–æ –±—ã —Ç—ã —Å–¥–µ–ª–∞–ª–∞ —Å —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–±—è –ø—Ä–µ–¥–∞–ª?",
    "–¢—ã –±—ã —Å–º–æ–≥–ª–∞ –ø—Ä–æ—Å—Ç–∏—Ç—å –∏–∑–º–µ–Ω—É?",
    "–ö–∞–∫—É—é —Ç–∞–π–Ω—É —Ç—ã —É–Ω–µ—Å–µ—à—å —Å —Å–æ–±–æ–π –≤ –º–æ–≥–∏–ª—É?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Ö—É–∂–µ: —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∏–ª–∏ –¥—É—à–µ–≤–Ω–∞—è –±–æ–ª—å?",
    
    # –†–û–ú–ê–ù–¢–ò–ß–ï–°–ö–ò–ï
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å –Ω–∞—Å—Ç–æ—è—â—É—é –ª—é–±–æ–≤—å?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ?",
    "–ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç—ã –∏—â–µ—à—å –≤ –ø–∞—Ä—Ç–Ω–µ—Ä–µ?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–æ–º–∞–Ω—Ç–∏–∫–∞ –¥–ª—è —Ç–µ–±—è?",
    "–¢—ã –≤–µ—Ä–∏—à—å –≤ –ª—é–±–æ–≤—å –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–µ–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å —Ñ—Ä–∞–∑—É '—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –¥—É—à–∞'?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞ –Ω–∞ –ø–µ—Ä–≤–æ–º —Å–≤–∏–¥–∞–Ω–∏–∏?",
    "–ö–∞–∫–∏–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã —Ç–µ–±–µ –ø—Ä–∏—è—Ç–Ω—ã?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–≤–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–±—è?",
    
    # –î–†–£–ñ–ë–ê
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∏–¥–µ–∞–ª—å–Ω–∞—è –ø–æ–¥—Ä—É–≥–∞?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å –Ω–∞—Å—Ç–æ—è—â—É—é –¥—Ä—É–∂–±—É?",
    "–ß—Ç–æ –±—ã —Ç—ã –ø—Ä–æ—Å—Ç–∏–ª–∞ –ø–æ–¥—Ä—É–≥–µ?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–æ –≤ –¥—Ä—É–∂–±–µ?",
    "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ –¥—Ä—É–∂–±–µ —Å –±—ã–≤—à–∏–º–∏?",
    "–ß—Ç–æ –±—ã —Ç—ã –¥–µ–ª–∞–ª–∞, –µ—Å–ª–∏ –±—ã –ø–æ–¥—Ä—É–≥–∞ –ø—Ä–µ–¥–∞–ª–∞?",
    "–ö–∞–∫ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å —Ñ—Ä–∞–∑—É '–¥—Ä—É–≥ –ø–æ–∑–Ω–∞–µ—Ç—Å—è –≤ –±–µ–¥–µ'?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –ª—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫ –æ—Ç –ø–æ–¥—Ä—É–≥–∏?",
    
    # –î–ï–¢–°–¢–í–û
    "–ö–∞–∫–æ–µ —Ç–≤–æ–µ —Å–∞–º–æ–µ —Å—á–∞—Å—Ç–ª–∏–≤–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞?",
    "–ö–µ–º —Ç—ã —Ö–æ—Ç–µ–ª–∞ —Å—Ç–∞—Ç—å –≤ –¥–µ—Ç—Å—Ç–≤–µ?",
    "–ß—Ç–æ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏–ª–æ—Å—å –µ—Å—Ç—å –≤ –¥–µ—Ç—Å—Ç–≤–µ?",
    "–ö–∞–∫–∞—è —É —Ç–µ–±—è –±—ã–ª–∞ –ª—é–±–∏–º–∞—è –∏–≥—Ä—É—à–∫–∞?",
    "–ß—Ç–æ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏–ª–æ—Å—å –¥–µ–ª–∞—Ç—å –≤ —à–∫–æ–ª–µ?",
    "–ö–∞–∫–æ–π —É —Ç–µ–±—è –±—ã–ª –ª—é–±–∏–º—ã–π –º—É–ª—å—Ç–∏–∫?",
    
    # –°–¢–†–ê–•–ò
    "–ß–µ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
    "–ö–∞–∫–∞—è —É —Ç–µ–±—è —Å–∞–º–∞—è —Å—Ç—Ä–∞–Ω–Ω–∞—è —Ñ–æ–±–∏—è?",
    "–ß—Ç–æ —Ç–µ–±—è –ø—É–≥–∞–ª–æ –≤ –¥–µ—Ç—Å—Ç–≤–µ?",
    "–ö–∞–∫ —Ç—ã –±–æ—Ä–µ—à—å—Å—è —Å–æ —Å—Ç—Ä–∞—Ö–∞–º–∏?",
    "–ß–µ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
    
    # –ú–ï–ß–¢–´
    "–ö–∞–∫–∞—è —Ç–≤–æ—è —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –º–µ—á—Ç–∞?",
    "–ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª–∞ —É—Å–ø–µ—Ç—å —Å–¥–µ–ª–∞—Ç—å –≤ –∂–∏–∑–Ω–∏?",
    "–ö–∞–∫–∏–µ —É —Ç–µ–±—è —Ü–µ–ª–∏ –Ω–∞ –≥–æ–¥?",
    "–ì–¥–µ —Ç—ã –º–µ—á—Ç–∞–µ—à—å –ø–æ–±—ã–≤–∞—Ç—å?",
    "–ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª–∞ –Ω–∞—É—á–∏—Ç—å—Å—è –¥–µ–ª–∞—Ç—å?",
    
    # –ï–î–ê
    "–¢–≤–æ–µ –ª—é–±–∏–º–æ–µ –±–ª—é–¥–æ?",
    "–ß—Ç–æ —Ç—ã –Ω–µ–Ω–∞–≤–∏–¥–∏—à—å –µ—Å—Ç—å?",
    "–ö–∞–∫—É—é –∫—É—Ö–Ω—é –º–∏—Ä–∞ —Ç—ã –ª—é–±–∏—à—å?",
    "–ß—Ç–æ —Ç—ã —É–º–µ–µ—à—å –≥–æ—Ç–æ–≤–∏—Ç—å –ª—É—á—à–µ –≤—Å–µ–≥–æ?",
    "–ö–∞–∫–æ–µ —Ç–≤–æ–µ –ª—é–±–∏–º–æ–µ –ª–∞–∫–æ–º—Å—Ç–≤–æ –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞?",
    
    # –ü–£–¢–ï–®–ï–°–¢–í–ò–Ø
    "–ì–¥–µ —Ç—ã —É–∂–µ –ø–æ–±—ã–≤–∞–ª–∞?",
    "–ö—É–¥–∞ —Ö–æ—á–µ—à—å –ø–æ–µ—Ö–∞—Ç—å?",
    "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –∏–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–ø—É—Å–∫?",
    "–¢—ã –ª—é–±–∏—à—å –ø–ª—è–∂–Ω—ã–π –æ—Ç–¥—ã—Ö –∏–ª–∏ —ç–∫—Å–∫—É—Ä—Å–∏–∏?",
    "–ö–∞–∫–∞—è —Å—Ç—Ä–∞–Ω–∞ —Ç–µ–±—è –≤–ø–µ—á–∞—Ç–ª–∏–ª–∞?",
    
    # –ö–ò–ù–û –ò –ú–£–ó–´–ö–ê
    "–¢–≤–æ–π –ª—é–±–∏–º—ã–π —Ñ–∏–ª—å–º?",
    "–ö–∞–∫–æ–π —Ñ–∏–ª—å–º –∑–∞—Å—Ç–∞–≤–∏–ª —Ç–µ–±—è –ø–ª–∞–∫–∞—Ç—å?",
    "–¢–≤–æ–π –ª—é–±–∏–º—ã–π –∞–∫—Ç–µ—Ä?",
    "–ö–∞–∫–æ–π —Å–µ—Ä–∏–∞–ª —Ç—ã –ª—é–±–∏—à—å?",
    "–¢–≤–æ—è –ª—é–±–∏–º–∞—è –ø–µ—Å–Ω—è —Å–µ–π—á–∞—Å?",
    
    # –ñ–ò–í–û–¢–ù–´–ï
    "–¢–≤–æ–µ –ª—é–±–∏–º–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ?",
    "–£ —Ç–µ–±—è –µ—Å—Ç—å –¥–æ–º–∞—à–Ω–∏–π –ø–∏—Ç–æ–º–µ—Ü?",
    "–ö–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ —Ç—ã –±—ã —Ö–æ—Ç–µ–ª–∞ –∑–∞–≤–µ—Å—Ç–∏?",
    "–ß—Ç–æ —Ç—ã –¥—É–º–∞–µ—à—å –æ –∫–æ—à–∫–∞—Ö?",
    "–ß—Ç–æ —Ç—ã –¥—É–º–∞–µ—à—å –æ —Å–æ–±–∞–∫–∞—Ö?",
]

print(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤: {len(QUESTIONS)}")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ (aiogram 3.x)
bot = Bot(token=API_TOKEN, default=DefaultBotProperties(parse_mode=ParseMode.HTML))
dp = Dispatcher()

# –•—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
sent_questions = {}

@dp.message(Command("start"))
async def start_command(message: types.Message):
    await message.reply(
        "üëã –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ø–æ–¥—Ä—É–≥–æ–π!\n\n"
        "–ö–æ–º–∞–Ω–¥—ã:\n"
        "/set_gender male/female - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª\n"
        "/stats - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/ask - –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å —Å–µ–π—á–∞—Å"
    )

@dp.message(Command("set_gender"))
async def set_gender(message: types.Message):
    try:
        gender = message.text.split()[1].lower()
        if gender in ['male', 'female']:
            USER_GENDERS[message.from_user.id] = gender
            text = "‚úÖ –ü–æ–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –º—É–∂—Å–∫–æ–π" if gender == 'male' else "‚úÖ –ü–æ–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –∂–µ–Ω—Å–∫–∏–π"
            await message.reply(text)
        else:
            await message.reply("‚ùå –ò—Å–ø–æ–ª—å–∑—É–π: /set_gender male –∏–ª–∏ /set_gender female")
    except:
        await message.reply("‚ùå –ò—Å–ø–æ–ª—å–∑—É–π: /set_gender male –∏–ª–∏ /set_gender female")

@dp.message(Command("stats"))
async def show_stats(message: types.Message):
    stats = f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n"
    stats += f"–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤: {len(QUESTIONS)}\n"
    stats += f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {len(sent_questions)}\n"
    stats += f"–ò–Ω—Ç–µ—Ä–≤–∞–ª: –∫–∞–∂–¥—ã–µ {INTERVAL_HOURS} —á.\n"
    await message.reply(stats)

@dp.message(Command("ask"))
async def ask_now(message: types.Message):
    await send_question()

@dp.callback_query(lambda c: c.data.startswith(('done', 'fail')))
async def process_callback(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    gender = USER_GENDERS.get(user_id, "female")
    
    if callback.data == 'done':
        text = "‚úÖ –í—ã–ø–æ–ª–Ω–∏–ª! –ú–æ–ª–æ–¥–µ—Ü! üëç" if gender == "male" else "‚úÖ –í—ã–ø–æ–ª–Ω–∏–ª–∞! –ú–æ–ª–æ–¥–µ—Ü! üëç"
    else:
        text = "‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–∏–ª... –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–ª—É—á–∏—Ç—Å—è! üí™" if gender == "male" else "‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∞... –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–ª—É—á–∏—Ç—Å—è! üí™"
    
    await callback.answer(text, show_alert=True)
    await callback.message.edit_reply_markup(reply_markup=None)

async def send_question():
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –≤–æ–ø—Ä–æ—Å –≤ —á–∞—Ç"""
    if not QUESTIONS:
        await bot.send_message(CHAT_ID, "‚ùå –í–æ–ø—Ä–æ—Å—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!")
        return
    
    question = random.choice(QUESTIONS)
    
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ", callback_data="done"),
            InlineKeyboardButton(text="‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ", callback_data="fail")
        ]
    ])
    
    await bot.send_message(
        CHAT_ID,
        f"üéØ <b>–í–æ–ø—Ä–æ—Å –¥–ª—è –æ–±—â–µ–Ω–∏—è:</b>\n\n{question}\n\n<i>–û—Ç–º–µ—Ç—å, –æ—Ç–≤–µ—Ç–∏–ª–∞ –ª–∏ —Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å:</i>",
        reply_markup=keyboard
    )
    
    sent_questions[question] = datetime.now()

async def scheduled_questions():
    """–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫"""
    while True:
        await send_question()
        await asyncio.sleep(INTERVAL_HOURS * 3600)

async def main():
    # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
    asyncio.create_task(scheduled_questions())
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!")
    print(f"üìä –í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤: {len(QUESTIONS)}")
    print(f"‚è∞ –ò–Ω—Ç–µ—Ä–≤–∞–ª: –∫–∞–∂–¥—ã–µ {INTERVAL_HOURS} —á–∞—Å–∞")
    print(f"üì® –ß–∞—Ç ID: {CHAT_ID}")
    print("=" * 50)
    await dp.start_polling(bot)

if __name__ == '__main__':
    asyncio.run(main())
